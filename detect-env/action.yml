name: detect environment
description: Detect environment

outputs:
  environment:
    description: The environment key
    value: ${{ steps.get-environment.outputs.environment }}

runs:
  using: composite
  steps:
    - name: Get environment
      id: get-environment
      shell: bash
      run: |
        if [ "${{ github.event.label.name }}" == "ready to test" && github.event.pull_request.base.ref == "develop" ]; then
          echo "environment=nonprod" >> $GITHUB_OUTPUT
        elif [ "${{ github.event_name }}" == "ready to deploy" && github.event.pull_request.base.ref == "main" ]; then
          echo "environment=prod" >> $GITHUB_OUTPUT
        fi